
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The DiffractionExperimentContext class &#8212; pydidas</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/_css/pydidas-custom.css?v=7afb26e6" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=853907ea"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'manuals/cmdline_global/cmd_diffraction_exp_context';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="The ScanContext class" href="cmd_scan_context.html" />
    <link rel="prev" title="pydidas general command line tutorial" href="cmd_global.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/pydidas_snakes_circ_bg.png" class="logo__image only-light" alt="pydidas"/>
    <script>document.write(`<img src="../../_static/pydidas_snakes_circ_bg.png" class="logo__image only-dark" alt="pydidas"/>`);</script>
  
  
    <p class="title logo__title"> pydidas</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../quickstart.html">
    Pydidas quick-start guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../manuals.html">
    Manuals
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../code/code_documentation.html">
    Code documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../developer_guide.html">
    Developer guide
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/hereon-GEMS/pydidas" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../quickstart.html">
    Pydidas quick-start guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../manuals.html">
    Manuals
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../code/code_documentation.html">
    Code documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../developer_guide.html">
    Developer guide
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/hereon-GEMS/pydidas" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../commandline.html">Command line manuals</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cmd_global.html">pydidas general command line tutorial</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">The DiffractionExperimentContext class</a></li>
<li class="toctree-l2"><a class="reference internal" href="cmd_scan_context.html">The ScanContext class</a></li>
<li class="toctree-l2"><a class="reference internal" href="cmd_workflow_tree.html">The WorkflowTree class</a></li>
<li class="toctree-l2"><a class="reference internal" href="cmd_workflow_results.html">The WorkflowResults class</a></li>
<li class="toctree-l2"><a class="reference internal" href="cmd_running_workflows.html">Running pydidas workflows from the command line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cmdline_apps/cmd_apps.html">Command line applications</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../gui/graphical_user_interface.html">Graphical user interface</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../manuals.html" class="nav-link">Manuals</a></li>
    
    
    <li class="breadcrumb-item"><a href="../commandline.html" class="nav-link">Command line manuals</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">The...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="the-diffractionexperimentcontext-class">
<span id="diffraction-exp-context"></span><h1>The DiffractionExperimentContext class<a class="headerlink" href="#the-diffractionexperimentcontext-class" title="Link to this heading">#</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#configuring-the-diffractionexperimentcontext" id="id2">Configuring the DiffractionExperimentContext</a></p>
<ul>
<li><p><a class="reference internal" href="#x-ray-energy-and-wavelength" id="id3">X-ray energy and wavelength</a></p></li>
<li><p><a class="reference internal" href="#the-detector" id="id4">The detector</a></p></li>
<li><p><a class="reference internal" href="#the-geometry" id="id5">The geometry</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#import-and-export" id="id6">Import and Export</a></p></li>
<li><p><a class="reference internal" href="#full-list-of-parameters-for-diffractionexperimentcontext" id="id7">Full list of Parameters for DiffractionExperimentContext</a></p></li>
</ul>
</nav>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">DiffractionExperimentContext</span></code>
is the pydidas Singleton instance of the
<a class="reference internal" href="../../code/api/contexts.html#pydidas.contexts.diff_exp.DiffractionExperiment" title="pydidas.contexts.diff_exp.DiffractionExperiment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffractionExperiment</span></code></a>
class. It is used for storing and accessing global information about the
experimental setup. Stored information include</p>
<ul class="simple">
<li><p>X-ray energy</p></li>
<li><p>detector model (pixel numbers and sizes)</p></li>
<li><p>detector geometry.</p></li>
</ul>
<p>All objects are stored as <a class="reference internal" href="../../code/api/core/parameter.html#pydidas.core.Parameter" title="pydidas.core.Parameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameters</span></code></a> and
can be accesses as described in the basic tutorial. A full list of Parameters is
given in <a class="reference internal" href="#diffraction-exp-context-parameters"><span class="std std-ref">Full list of Parameters for DiffractionExperimentContext</span></a>.</p>
<p>Its instance can be obtained by running the following code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pydidas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">contexts</span><span class="o">.</span><span class="n">DiffractionExperimentContext</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="configuring-the-diffractionexperimentcontext">
<h2>Configuring the DiffractionExperimentContext<a class="headerlink" href="#configuring-the-diffractionexperimentcontext" title="Link to this heading">#</a></h2>
<section id="x-ray-energy-and-wavelength">
<h3>X-ray energy and wavelength<a class="headerlink" href="#x-ray-energy-and-wavelength" title="Link to this heading">#</a></h3>
<p>The X-ray energy and wavelength are two coupled Parameters and any changes to
one will cause the other Parameter to be updated as well. They can be accessed
through the keys <code class="xref py py-data docutils literal notranslate"><span class="pre">xray_energy</span></code> and <code class="xref py py-data docutils literal notranslate"><span class="pre">xray_wavelength</span></code>,
respectively.</p>
<p>Please see also the example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pydidas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">contexts</span><span class="o">.</span><span class="n">DiffractionExperimentContext</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">get_param_value</span><span class="p">(</span><span class="s1">&#39;xray_wavelength&#39;</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">get_param_value</span><span class="p">(</span><span class="s1">&#39;xray_energy&#39;</span><span class="p">)</span>
<span class="go">12.398</span>

<span class="go"># Now, set the wavelength and check the energy:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;xray_wavelength&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">get_param_value</span><span class="p">(</span><span class="s1">&#39;xray_energy&#39;</span><span class="p">)</span>
<span class="go">6.199209921660013</span>

<span class="go"># Or change the X-ray energy:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;xray_energy&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">get_param_value</span><span class="p">(</span><span class="s1">&#39;xray_wavelength&#39;</span><span class="p">)</span>
<span class="go">1.0332016536100022</span>
</pre></div>
</div>
</section>
<section id="the-detector">
<h3>The detector<a class="headerlink" href="#the-detector" title="Link to this heading">#</a></h3>
<p>The detector is defined by the following Parameters:</p>
<div class="pst-scrollable-table-container"><table class="tight-table table">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>type</p></th>
<th class="head"><p>unit</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>detector_name</p></td>
<td><p>str</p></td>
<td><p>n/a</p></td>
<td><p>The detector name in pyFAI nomenclature.</p></td>
</tr>
<tr class="row-odd"><td><p>detector_npixx</p></td>
<td><p>int</p></td>
<td><p>pixel</p></td>
<td><p>The number of detector pixels in x direction (horizontal).</p></td>
</tr>
<tr class="row-even"><td><p>detector_npixy</p></td>
<td><p>int</p></td>
<td><p>pixel</p></td>
<td><p>The number of detector pixels in y direction (vertical).</p></td>
</tr>
<tr class="row-odd"><td><p>detector_pxsizex</p></td>
<td><p>float</p></td>
<td><p>um</p></td>
<td><p>The detector pixel size in X-direction.</p></td>
</tr>
<tr class="row-even"><td><p>detector_pxsizey</p></td>
<td><p>float</p></td>
<td><p>um</p></td>
<td><p>The detector pixel size in Y-direction.</p></td>
</tr>
<tr class="row-odd"><td><p>detector_mask_file (optional)</p></td>
<td><p>str</p></td>
<td><p>n/a</p></td>
<td><p>The path and filename for the detector mask file. This file is used in
pyFAI integration plugins.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The <code class="xref py py-data docutils literal notranslate"><span class="pre">detector_name</span></code> is only relevant for referencing any pyFAI object
but is included in the metainformation and should be set correctly. The
Parameters for numbers of pixels and pixelsize exactly what the name suggests.</p>
<section id="defining-the-detector-manually">
<h4>Defining the detector manually<a class="headerlink" href="#defining-the-detector-manually" title="Link to this heading">#</a></h4>
<p>The detector can be defined manually if required, for example for a prototype
detector which is not inclued in pyFAI, by setting all Parameters values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pydidas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">contexts</span><span class="o">.</span><span class="n">DiffractionExperimentContext</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;detector_name&#39;</span><span class="p">,</span> <span class="s1">&#39;A detector with very small asymmetric pixels&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;detector_npixx&#39;</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;detector_npixy&#39;</span><span class="p">,</span> <span class="mi">2048</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;detector_pxsizex&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;detector_pxsizey&#39;</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-a-pyfai-detector">
<h4>Using a pyFAI detector<a class="headerlink" href="#using-a-pyfai-detector" title="Link to this heading">#</a></h4>
<p>If the detector is defined in pyFAI, this library can be used to update the
detector settings automatically by giving the detector name in the
<a class="reference internal" href="../../code/api/contexts.html#pydidas.contexts.diff_exp.DiffractionExperiment.set_detector_params_from_name" title="pydidas.contexts.diff_exp.DiffractionExperiment.set_detector_params_from_name"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_detector_params_from_name</span></code></a>
method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pydidas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">contexts</span><span class="o">.</span><span class="n">DiffractionExperimentContext</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_detector_params_from_name</span><span class="p">(</span><span class="s1">&#39;Eiger 9M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">get_param_value</span><span class="p">(</span><span class="s1">&#39;detector_name&#39;</span><span class="p">)</span>
<span class="go">&#39;Eiger 9M&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">get_param_value</span><span class="p">(</span><span class="s1">&#39;detector_npixx&#39;</span><span class="p">)</span>
<span class="go">3110</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">get_param_value</span><span class="p">(</span><span class="s1">&#39;detector_npixy&#39;</span><span class="p">)</span>
<span class="go">3269</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">get_param_value</span><span class="p">(</span><span class="s1">&#39;detector_pxsizex&#39;</span><span class="p">)</span>
<span class="go">75.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">get_param_value</span><span class="p">(</span><span class="s1">&#39;detector_pxsizey&#39;</span><span class="p">)</span>
<span class="go">75.0</span>
</pre></div>
</div>
</section>
</section>
<section id="the-geometry">
<h3>The geometry<a class="headerlink" href="#the-geometry" title="Link to this heading">#</a></h3>
<p>pydidas uses the pyFAI geometry. In short, it uses the point of normal
incidence (PONI), the orthogonal projection of the origin (i.e. the sample) on
the detector.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The pyFAI geometry is described in detail in this pyFAI document:
<a class="reference external" href="https://pyfai.readthedocs.io/en/master/geometry.html#default-geometry-in-pyfai">Default geometry in pyFAI</a>.</p>
</div>
<p>The pyFAI coordinate system used the <span class="math notranslate nohighlight">\(x_1\)</span> (up), <span class="math notranslate nohighlight">\(x_2\)</span> and
<span class="math notranslate nohighlight">\(x_3\)</span> (along the beam direction) coordinates. The <span class="math notranslate nohighlight">\(x_2\)</span> axis is
defined to create a right-handed coordinate system with the <span class="math notranslate nohighlight">\(x_1\)</span> and
<span class="math notranslate nohighlight">\(x_3\)</span> axes.</p>
<p>The PONI defines the <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> coordinates of the detector
(measured from the origin at the top left corner) and the distance in beam
direction defines the <span class="math notranslate nohighlight">\(x_3\)</span> coordinate (detector distance).</p>
<p>Three rotations (<span class="math notranslate nohighlight">\(rot_1\)</span>: mathmatically negative around the axis pointing
up; <span class="math notranslate nohighlight">\(rot_2\)</span>: mathematically negative around the <span class="math notranslate nohighlight">\(x_2\)</span> axis;
<span class="math notranslate nohighlight">\(rot_3\)</span>: mathematically positive (!) around the X-ray beam direction) are
used to move the detector with respect to the origin (sample) are applied to
the detector to transform the detector geometry into the experimental geometry.</p>
<p>The correspondence between pyFAI geometry and pydidas DiffractionExperimentContext
Parameter names is given below:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>pyFAI parameter name</p></th>
<th class="head"><p>corresponding pydidas Parameter</p></th>
<th class="head"><p>unit</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(poni_1\)</span></p></td>
<td><p>detector_poni1</p></td>
<td><p>m</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(poni_2\)</span></p></td>
<td><p>detector_poni2</p></td>
<td><p>m</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(dist\)</span></p></td>
<td><p>detector_dist</p></td>
<td><p>m</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(rot_1\)</span></p></td>
<td><p>detector_rot1</p></td>
<td><p>rad</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(rot_2\)</span></p></td>
<td><p>detector_rot2</p></td>
<td><p>rad</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(rot_3\)</span></p></td>
<td><p>detector_rot3</p></td>
<td><p>rad</p></td>
</tr>
</tbody>
</table>
</div>
<section id="defining-the-geometry">
<h4>Defining the geometry<a class="headerlink" href="#defining-the-geometry" title="Link to this heading">#</a></h4>
<p>These Parameters can be accessed and updated by the pydidas Parameter names as
given in the table above. For an example, see below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pydidas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">contexts</span><span class="o">.</span><span class="n">DiffractionExperimentContext</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;detector_poni1&#39;</span><span class="p">,</span> <span class="mf">0.114731</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;detector_poni2&#39;</span><span class="p">,</span> <span class="mf">0.123635</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;detector_dist&#39;</span><span class="p">,</span> <span class="mf">0.235885</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;detector_rot1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.011062669</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;detector_rot2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.002172149</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;detector_rot3&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="import-and-export">
<h2>Import and Export<a class="headerlink" href="#import-and-export" title="Link to this heading">#</a></h2>
<p>The DiffractionExperimentContext settings can be imported and exported to files, based on
the available im-/exporters. The standard distribution ships with support for
YAML files and pyFAI .poni files. Both types are supported for import and
export. The format will be determined automatically based on the file extension.</p>
<p>Imports and exports are started by calling the
<a class="reference internal" href="../../code/api/contexts.html#pydidas.contexts.diff_exp.DiffractionExperiment.import_from_file" title="pydidas.contexts.diff_exp.DiffractionExperiment.import_from_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">import_from_file(filename)</span></code></a>
and
<a class="reference internal" href="../../code/api/contexts.html#pydidas.contexts.diff_exp.DiffractionExperiment.export_to_file" title="pydidas.contexts.diff_exp.DiffractionExperiment.export_to_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">export_to_file(filename)</span></code></a>,
respectively. The filename must include the absolute path to the file.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Importing the <a class="reference internal" href="../../code/api/contexts.html#pydidas.contexts.diff_exp.DiffractionExperiment" title="pydidas.contexts.diff_exp.DiffractionExperiment"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffractionExperimentContext</span></code></a>
from file will overwrite all current values without asking for confirmation.</p>
</div>
<p>An example to demonstrate these methods is given below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pydidas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">contexts</span><span class="o">.</span><span class="n">DiffractionExperimentContext</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">get_param_values_as_dict</span><span class="p">()</span>
<span class="go">{&#39;xray_wavelength&#39;: 1,</span>
<span class="go"> &#39;xray_energy&#39;: 12.398,</span>
<span class="go"> &#39;detector_name&#39;: &#39;detector&#39;,</span>
<span class="go"> &#39;detector_npixx&#39;: 0,</span>
<span class="go"> &#39;detector_npixy&#39;: 0,</span>
<span class="go"> &#39;detector_pxsizex&#39;: -1,</span>
<span class="go"> &#39;detector_pxsizey&#39;: -1,</span>
<span class="go"> &#39;detector_dist&#39;: 1,</span>
<span class="go"> &#39;detector_poni1&#39;: 0,</span>
<span class="go"> &#39;detector_poni2&#39;: 0,</span>
<span class="go"> &#39;detector_rot1&#39;: 0,</span>
<span class="go"> &#39;detector_rot2&#39;: 0,</span>
<span class="go"> &#39;detector_rot3&#39;: 0}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">export_to_file</span><span class="p">(</span><span class="s1">&#39;/scratch/exp_settings_test.yaml&#39;</span><span class="p">)</span>

<span class="go"># now, we update the local settings:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">set_detector_params_from_name</span><span class="p">(</span><span class="s1">&#39;Eiger 9M&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">get_param_values_as_dict</span><span class="p">()</span>
<span class="go">{&#39;xray_wavelength&#39;: 1,</span>
<span class="go"> &#39;xray_energy&#39;: 12.398,</span>
<span class="go"> &#39;detector_name&#39;: &#39;Eiger 9M&#39;,</span>
<span class="go"> &#39;detector_npixx&#39;: 3110,</span>
<span class="go"> &#39;detector_npixy&#39;: 3269,</span>
<span class="go"> &#39;detector_pxsizex&#39;: 75.0,</span>
<span class="go"> &#39;detector_pxsizey&#39;: 75.0,</span>
<span class="go"> &#39;detector_dist&#39;: 1,</span>
<span class="go"> &#39;detector_poni1&#39;: 0,</span>
<span class="go"> &#39;detector_poni2&#39;: 0,</span>
<span class="go"> &#39;detector_rot1&#39;: 0,</span>
<span class="go"> &#39;detector_rot2&#39;: 0,</span>
<span class="go"> &#39;detector_rot3&#39;: 0}</span>

<span class="go"># If we load the settings from the stored file, these settings will be lost</span>
<span class="go"># and the saved state will be restored:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">import_from_file</span><span class="p">(</span><span class="s1">&#39;/scratch/exp_settings_test.yaml&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">get_param_values_as_dict</span><span class="p">()</span>
<span class="go">{&#39;xray_wavelength&#39;: 1,</span>
<span class="go"> &#39;xray_energy&#39;: 12.398,</span>
<span class="go"> &#39;detector_name&#39;: &#39;detector&#39;,</span>
<span class="go"> &#39;detector_npixx&#39;: 0,</span>
<span class="go"> &#39;detector_npixy&#39;: 0,</span>
<span class="go"> &#39;detector_pxsizex&#39;: -1,</span>
<span class="go"> &#39;detector_pxsizey&#39;: -1,</span>
<span class="go"> &#39;detector_dist&#39;: 1,</span>
<span class="go"> &#39;detector_poni1&#39;: 0,</span>
<span class="go"> &#39;detector_poni2&#39;: 0,</span>
<span class="go"> &#39;detector_rot1&#39;: 0,</span>
<span class="go"> &#39;detector_rot2&#39;: 0,</span>
<span class="go"> &#39;detector_rot3&#39;: 0}</span>
</pre></div>
</div>
<span class="target" id="diffraction-exp-context-parameters"></span></section>
<section id="full-list-of-parameters-for-diffractionexperimentcontext">
<h2>Full list of Parameters for DiffractionExperimentContext<a class="headerlink" href="#full-list-of-parameters-for-diffractionexperimentcontext" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><dl class="simple">
<dt>xray_wavelength (float, unit: Angstrom, default: 1.0)</dt><dd><p>The X-ray wavelength. Any changes to the wavelength will also update
the X-ray energy setting.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>xray_energy (float, unit: keV, default: 12.398)</dt><dd><p>The X-ray energy. Changing this parameter will also update the X-ray
wavelength setting.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detector_name (str, default: “detector”)</dt><dd><p>The detector name (in pyFAI nomenclature if used for automatic
configuration).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detector_npixx (int, default: 0)</dt><dd><p>The number of detector pixels in x direction (horizontal).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detector_npixy (int, default: 0)</dt><dd><p>The number of detector pixels in x direction (vertical).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detector_pxsizex (float, unit: um, default: -1)</dt><dd><p>The detector pixel size in X-direction.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detector_pxsizey (float, unit: um, default: -1)</dt><dd><p>The detector pixel size in Y-direction.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detector_mask_file (str, default: .)</dt><dd><p>The path to the detector mask file. If empty, this defaults to no detector
mask.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detector_dist (float, unit: m, default: 1.0)</dt><dd><p>The sample-detector distance.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detector_poni1 (float, unit: m, default: 0.0)</dt><dd><p>The detector PONI1 (point of normal incidence; in y direction). This is
measured in meters from the detector origin.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detector_poni2 (float, unit: m, default: 0.0)</dt><dd><p>The detector PONI2 (point of normal incidence; in x direction). This is
measured in meters from the detector origin.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detector_rot1 (float, unit: rad, default: 0.0)</dt><dd><p>The detector rotation 1 (yaw; lefthanded around the “up”-axis)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detector_rot2 (float, unit: rad, default: 0.0)</dt><dd><p>The detector rotation 2 (pitching the detector; positive direction is
tilting the detector top upstream while keeping the bottom of the
detector stationary.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>detector_rot3 (float, unit: rad, default: 0.0)</dt><dd><p>The detector rotation 3 (roll; around the beam axis; right-handed when
looking downstream with the beam.)</p>
</dd>
</dl>
</li>
</ul>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="cmd_global.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">pydidas general command line tutorial</p>
      </div>
    </a>
    <a class="right-next"
       href="cmd_scan_context.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The ScanContext class</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuring-the-diffractionexperimentcontext">Configuring the DiffractionExperimentContext</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#x-ray-energy-and-wavelength">X-ray energy and wavelength</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-detector">The detector</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-the-detector-manually">Defining the detector manually</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-pyfai-detector">Using a pyFAI detector</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-geometry">The geometry</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-the-geometry">Defining the geometry</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-and-export">Import and Export</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#full-list-of-parameters-for-diffractionexperimentcontext">Full list of Parameters for DiffractionExperimentContext</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/manuals/cmdline_global/cmd_diffraction_exp_context.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023 - 2024, Helmholtz-Zentrum Hereon.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>