
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial for the DirectorySpyApp &#8212; pydidas</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/_css/pydidas-custom.css?v=7afb26e6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=4487a728"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'manuals/cmdline_apps/cmd_directory_spy_app';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/hereon-GEMS/pydidas/gh-pages-version-snapshots/pydata_version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '"24.09.16"';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = true;
        </script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Graphical user interface" href="../gui/graphical_user_interface.html" />
    <link rel="prev" title="Tutorial for the ExecuteWorkflowApp" href="cmd_execute_workflow_app.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/pydidas_snakes_circ_bg.png" class="logo__image only-light" alt="pydidas"/>
    <script>document.write(`<img src="../../_static/pydidas_snakes_circ_bg.png" class="logo__image only-dark" alt="pydidas"/>`);</script>
  
  
    <p class="title logo__title"> pydidas</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../manuals_main.html">
    User manuals
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../code/code_documentation.html">
    Code documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../dev_guide/developer_guide.html">
    Developer guide
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/hereon-GEMS/pydidas" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../manuals_main.html">
    User manuals
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../code/code_documentation.html">
    Code documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../dev_guide/developer_guide.html">
    Developer guide
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/hereon-GEMS/pydidas" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Pydidas quick-start guide</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../commandline_start.html">Command line manuals</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../cmdline_global/cmd_global.html">pydidas general command line tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cmdline_global/cmd_diffraction_exp_context.html">The DiffractionExperimentContext class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cmdline_global/cmd_scan_context.html">The ScanContext class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cmdline_global/cmd_workflow_tree.html">The WorkflowTree class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cmdline_global/cmd_workflow_results.html">The WorkflowResults class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cmdline_global/cmd_running_workflows.html">Running pydidas workflows from the command line</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="cmd_apps.html">Command line applications</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="cmd_running_apps.html">Running pydidas applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="cmd_composite_creator_app.html">Tutorial for the CompositeCreatorApp</a></li>
<li class="toctree-l3"><a class="reference internal" href="cmd_execute_workflow_app.html">Tutorial for the ExecuteWorkflowApp</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Tutorial for the DirectorySpyApp</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../gui/graphical_user_interface.html">Graphical user interface</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">





<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../manuals_main.html" class="nav-link">User manuals</a></li>
    
    
    <li class="breadcrumb-item"><i class="fa-solid fa-ellipsis"></i></li>
    
    
    <li class="breadcrumb-item"><a href="cmd_apps.html" class="nav-link">Command line applications</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Tutorial...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="tutorial-for-the-directoryspyapp">
<h1>Tutorial for the DirectorySpyApp<a class="headerlink" href="#tutorial-for-the-directoryspyapp" title="Link to this heading">#</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#motivation" id="id1">Motivation</a></p></li>
<li><p><a class="reference internal" href="#setup-of-the-directoryspyapp" id="id2">Setup of the DirectorySpyApp</a></p>
<ul>
<li><p><a class="reference internal" href="#selection-of-input-data" id="id3">Selection of input data</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#detector-mask-and-background-image" id="id4">Detector mask and background image</a></p>
<ul>
<li><p><a class="reference internal" href="#using-a-mask-file" id="id5">Using a mask file</a></p></li>
<li><p><a class="reference internal" href="#using-a-background-file" id="id6">Using a background file</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#running-the-directoryspyapp" id="id7">Running the DirectorySpyApp</a></p></li>
<li><p><a class="reference internal" href="#accessing-results" id="id8">Accessing results</a></p>
<ul>
<li><p><a class="reference internal" href="#accessing-results-within-python" id="id9">Accessing results within Python</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#directoryspyapp-parameters" id="id10">DirectorySpyApp Parameters</a></p></li>
</ul>
</nav>
<section id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Link to this heading">#</a></h2>
<p>The <a class="reference internal" href="../../code/api/apps/directory_spy_app.html#pydidas.apps.DirectorySpyApp" title="pydidas.apps.DirectorySpyApp"><code class="xref py py-class docutils literal notranslate"><span class="pre">DirectorySpyApp</span></code></a> is
designed to keep track of the files in a directory and notify the user if a new
file (with a specific filename pattern) has been created or changed.
If configured to do so, it will also supply the image data of the latest image
as well as the filename.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While the use of different Parameters is handled in different sections of
this manual, they must all be combined to use all capabilities of the
<a class="reference internal" href="../../code/api/apps/directory_spy_app.html#pydidas.apps.DirectorySpyApp" title="pydidas.apps.DirectorySpyApp"><code class="xref py py-class docutils literal notranslate"><span class="pre">DirectorySpyApp</span></code></a>.</p>
</div>
</section>
<section id="setup-of-the-directoryspyapp">
<h2>Setup of the DirectorySpyApp<a class="headerlink" href="#setup-of-the-directoryspyapp" title="Link to this heading">#</a></h2>
<p>This section describes the different input Parameters that can be used and gives
an overview of the <a class="reference internal" href="#directory-spy-app-params"><span class="std std-ref">DirectorySpyApp Parameters</span></a> at the end of the
section.</p>
<section id="selection-of-input-data">
<h3>Selection of input data<a class="headerlink" href="#selection-of-input-data" title="Link to this heading">#</a></h3>
<p>First of all, the user must specify the <code class="xref py py-data docutils literal notranslate"><span class="pre">directory_path</span></code> Parameter to
define the working directory. In addition, the user must decide whether the app
will scan for all new files the selected directory or only for files matching
a specific filename pattern. In the latter case, the <code class="xref py py-data docutils literal notranslate"><span class="pre">filename_pattern</span></code>
Parameter is used and must include the filename pattern with hashes “#” for
the counting variable.</p>
<p>The file finding behaviour is controlled through the <code class="xref py py-data docutils literal notranslate"><span class="pre">scan_for_all</span></code>
Parameter. If set to <code class="xref py py-data docutils literal notranslate"><span class="pre">True</span></code>, the app will look for all files in a
directory. If <code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code>, it will only look for incremental counts
according to the filename pattern and the current index.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using the <code class="xref py py-data docutils literal notranslate"><span class="pre">scan_for_all=True</span></code> setting will be slow in directories
with many files and it is not recommended.</p>
</div>
<p>The <code class="xref py py-data docutils literal notranslate"><span class="pre">filename_pattern</span></code> Parameter only includes the filename with
hash characters as wildcards. The number of wildcard characters must correspond
to the length of the numbers to be replaced and it will be filled with leading
zeros.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only a single set of wildcars is accepted. Please leave all other numbers
in place.</p>
</div>
<p>If HDF5 files are used, the dataset to use must be specified with the
<code class="xref py py-data docutils literal notranslate"><span class="pre">hdf5_key</span></code>. The frame cannot be selected as the DirectorySpyApp will
always show the latest frame.</p>
<p>See <a class="reference internal" href="cmd_composite_creator_app.html#composite-creator-app-params"><span class="std std-ref">Complete list of CompositeCreatorApp Parameters</span></a> for the detailed list of all Parameters.</p>
<section id="example-1-scanning-for-all-files">
<h4>Example 1: Scanning for all files<a class="headerlink" href="#example-1-scanning-for-all-files" title="Link to this heading">#</a></h4>
<p>For the first example, we want to scan for all new files in the
<em>/scratch/scan_42/</em> directory. We expect Hdf5 files with the data in the
<em>entry/other_data/data/</em> dataset.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pydidas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">apps</span><span class="o">.</span><span class="n">DirectorySpyApp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;scan_for-all&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;directory_path&#39;</span><span class="p">,</span> <span class="s1">&#39;/scratch/scan_42/&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;hdf5_key&#39;</span><span class="p">,</span> <span class="s1">&#39;/entry/other_data/data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="example-2-scanning-for-new-tiff-files">
<h4>Example 2: Scanning for new tiff files<a class="headerlink" href="#example-2-scanning-for-new-tiff-files" title="Link to this heading">#</a></h4>
<p>For this example, we want to load Tiff files from the <em>/scratch/test_scan/</em>
directory. The files are named <em>test_scan_01_0001.tiff</em>,
<em>test_scan_01_0002.tiff</em> etc.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pydidas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">apps</span><span class="o">.</span><span class="n">DirectorySpyApp</span><span class="p">()</span>
<span class="go"># scan_for_all is False by default, no need to set it.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;directory_path&#39;</span><span class="p">,</span> <span class="s1">&#39;/scratch/test_scan&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;filename_pattern&#39;</span><span class="p">,</span> <span class="s1">&#39;test_scan_01_####.tiff&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="detector-mask-and-background-image">
<h2>Detector mask and background image<a class="headerlink" href="#detector-mask-and-background-image" title="Link to this heading">#</a></h2>
<section id="using-a-mask-file">
<h3>Using a mask file<a class="headerlink" href="#using-a-mask-file" title="Link to this heading">#</a></h3>
<p>A mask file can be used by activating the <code class="xref py py-data docutils literal notranslate"><span class="pre">use_det_mask</span></code>
Parameter. This will instruct the app to apply the detector mask to the data
frame.</p>
<p>To modify the detector mask used by the DirectorySpyApp, set the
<code class="xref py py-data docutils literal notranslate"><span class="pre">detector_mask_file</span></code> Parameter to point to the mask file. The value
taken for masked pixels is controlled by the <code class="xref py py-data docutils literal notranslate"><span class="pre">det_mask_val</span></code> Parameter.
The default value is 0.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pydidas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">apps</span><span class="o">.</span><span class="n">DirectorySpyApp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s2">&quot;use_detector_mask&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s2">&quot;detector_mask_file&quot;</span><span class="p">,</span> <span class="s1">&#39;/home/user/data/detector_mask.npy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-a-background-file">
<h3>Using a background file<a class="headerlink" href="#using-a-background-file" title="Link to this heading">#</a></h3>
<p>Usage of a background file (which will be subtracted from all frames) can be
activated by setting the <code class="xref py py-data docutils literal notranslate"><span class="pre">use_bg_file</span></code> Parameter to True.</p>
<p>The background file itself can be selected by specifying the <code class="xref py py-data docutils literal notranslate"><span class="pre">bg_file</span></code>
Parameter. If a hdf5 file is selected, the dataset and frame can be given by
the <code class="xref py py-data docutils literal notranslate"><span class="pre">bg_hdf5_key</span></code> and <code class="xref py py-data docutils literal notranslate"><span class="pre">bg_hdf5_frame</span></code> Parameters. These
values default to <em>entry/data/data</em> and 0, respectively.</p>
<p>As example, let us use the first frame (i.e. zero) from the
<em>/scratch/scan_42/test.h5df5</em> file and the <em>entry/detector/data</em> dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pydidas</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">apps</span><span class="o">.</span><span class="n">DirectorySpyApp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;use_bg_file&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;bg_file&#39;</span><span class="p">,</span> <span class="s1">&#39;/scratch/scan_42/test.h5df5&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">set_param_value</span><span class="p">(</span><span class="s1">&#39;bg_hdf5_key&#39;</span><span class="p">,</span> <span class="s1">&#39;entry/detector/data&#39;</span><span class="p">)</span>
<span class="go"># Because the bg_hdf5_frame defaults to 0, this Parameter does not need to</span>
<span class="go"># be modified:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">get_param_value</span><span class="p">(</span><span class="s1">&#39;bg_hdf5_frame&#39;</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</section>
</section>
<section id="running-the-directoryspyapp">
<h2>Running the DirectorySpyApp<a class="headerlink" href="#running-the-directoryspyapp" title="Link to this heading">#</a></h2>
<p>Once configured, the <a class="reference internal" href="../../code/api/apps/directory_spy_app.html#pydidas.apps.DirectorySpyApp" title="pydidas.apps.DirectorySpyApp"><code class="xref py py-class docutils literal notranslate"><span class="pre">DirectorySpyApp</span></code></a>
is run like any pydidas app, as described in detail in
<a class="reference internal" href="cmd_running_apps.html#running-pydidas-applications"><span class="std std-ref">Running pydidas applications</span></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because the DirectorySpyApp does not use tasks and is running indefinitely
until stopped, it <strong>cannot</strong> be run serially.</p>
</div>
<p>To run it utilizing parallelization, set up an
<a class="reference internal" href="../../code/api/multiprocessing.html#pydidas.multiprocessing.AppRunner" title="pydidas.multiprocessing.AppRunner"><code class="xref py py-class docutils literal notranslate"><span class="pre">AppRunner</span></code></a> and use the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">start</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">apps</span><span class="o">.</span><span class="n">DirectorySpyApp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">runner</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">AppRunner</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">runner</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="accessing-results">
<h2>Accessing results<a class="headerlink" href="#accessing-results" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="../../code/api/apps/directory_spy_app.html#pydidas.apps.DirectorySpyApp" title="pydidas.apps.DirectorySpyApp"><code class="xref py py-class docutils literal notranslate"><span class="pre">DirectorySpyApp</span></code></a> results can
be only be accessed indirectly within Python.</p>
<section id="accessing-results-within-python">
<h3>Accessing results within Python<a class="headerlink" href="#accessing-results-within-python" title="Link to this heading">#</a></h3>
<p>The results can be accessed through the <code class="xref py py-data docutils literal notranslate"><span class="pre">image</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">filename</span></code>
and <code class="xref py py-data docutils literal notranslate"><span class="pre">image_metadata</span></code> properties. Note that this requires to connect
the AppRunner <code class="xref py py-data docutils literal notranslate"><span class="pre">sig_results</span></code> with the local app’s
<a class="reference internal" href="../../code/api/apps/directory_spy_app.html#pydidas.apps.DirectorySpyApp.multiprocessing_store_results" title="pydidas.apps.DirectorySpyApp.multiprocessing_store_results"><code class="xref py py-meth docutils literal notranslate"><span class="pre">multiprocessing_store_results</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">apps</span><span class="o">.</span><span class="n">DirectorySpyApp</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">runner</span> <span class="o">=</span> <span class="n">pydidas</span><span class="o">.</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">AppRunner</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">runner</span><span class="o">.</span><span class="n">sig_results</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">multiprocessing_store_results</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">runner</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">image</span>
<span class="go">array([[0.98215663, 0.30682687, 0.21160315, ..., 0.2604671 , 0.59461537,</span>
<span class="go">    0.09863754],</span>
<span class="go">   [0.51141869, 0.32276036, 0.43406916, ..., 0.02741798, 0.91533116,</span>
<span class="go">    0.79145334],</span>
<span class="go">   [0.1881628 , 0.4708237 , 0.14207525, ..., 0.26664729, 0.68337244,</span>
<span class="go">    0.83566994],</span>
<span class="go">   ...,</span>
<span class="go">   [0.6985084 , 0.58230171, 0.11641333, ..., 0.3299515 , 0.29834082,</span>
<span class="go">    0.19949315],</span>
<span class="go">   [0.54581434, 0.96941275, 0.21216339, ..., 0.26659825, 0.13700608,</span>
<span class="go">    0.01721194],</span>
<span class="go">   [0.74946649, 0.24262777, 0.94001868, ..., 0.29572706, 0.68824381,</span>
<span class="go">    0.61529555]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span><span class="o">.</span><span class="n">filename</span>
<span class="go">/scratch/test_scan/test_scan_01_0004.tiff</span>
</pre></div>
</div>
</section>
</section>
<section id="directoryspyapp-parameters">
<span id="directory-spy-app-params"></span><h2>DirectorySpyApp Parameters<a class="headerlink" href="#directoryspyapp-parameters" title="Link to this heading">#</a></h2>
<blockquote>
<div><dl class="simple">
<dt>scan_for_all (type: bool, default: False)</dt><dd><p>Flag to toggle scanning for all new files or only for files matching
the input pattern (defined with the Parameter
<code class="xref py py-data docutils literal notranslate"><span class="pre">filename_pattern</span></code>).</p>
</dd>
<dt>filename_pattern (type: pathlib.Path, default: &lt;empty Path&gt;)</dt><dd><p>The pattern of the filename. Use hashes “#” for wildcards which will
be filled in with numbers. This Parameter must be set if
<code class="xref py py-data docutils literal notranslate"><span class="pre">scan_for_all</span></code> is <code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt>directory_path (type: pathlib.Path, default: &lt;empty Path&gt;)</dt><dd><p>The absolute path of the directory to be used.</p>
</dd>
<dt>hdf5_key (type: Hdf5key, default: entry/data/data)</dt><dd><p>Used only for hdf5 files: The dataset key.</p>
</dd>
<dt>use_global_det_mask (type: bool, default: True)</dt><dd><p>Keyword to enable or disable using the global detector mask as
defined by the global mask file and mask value.</p>
</dd>
<dt>use_bg_file (type: bool, default: False)</dt><dd><p>Keyword to toggle usage of background subtraction.</p>
</dd>
<dt>bg_file (type: pathlib.Path, default: &lt;empty Path&gt;)</dt><dd><p>The name of the file used for background correction.</p>
</dd>
<dt>bg_hdf5_key (type: Hdf5key, default: entry/data/data)</dt><dd><p>Required for hdf5 background image files: The dataset key with the
image for the background file.</p>
</dd>
<dt>bg_hdf5_frame (type: int, default: 0)</dt><dd><p>Required for hdf5 background image files: The image number of the
background image in the dataset.</p>
</dd>
</dl>
</div></blockquote>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="cmd_execute_workflow_app.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial for the ExecuteWorkflowApp</p>
      </div>
    </a>
    <a class="right-next"
       href="../gui/graphical_user_interface.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Graphical user interface</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation">Motivation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup-of-the-directoryspyapp">Setup of the DirectorySpyApp</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#selection-of-input-data">Selection of input data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1-scanning-for-all-files">Example 1: Scanning for all files</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2-scanning-for-new-tiff-files">Example 2: Scanning for new tiff files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#detector-mask-and-background-image">Detector mask and background image</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-mask-file">Using a mask file</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-a-background-file">Using a background file</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-directoryspyapp">Running the DirectorySpyApp</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-results">Accessing results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-results-within-python">Accessing results within Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#directoryspyapp-parameters">DirectorySpyApp Parameters</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/hereon-GEMS/pydidas/edit/master/pydidas/docs/src/manuals/cmdline_apps/cmd_directory_spy_app.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/manuals/cmdline_apps/cmd_directory_spy_app.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2021 - 2024, Helmholtz-Zentrum Hereon.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.0.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>